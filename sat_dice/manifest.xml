<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE extension SYSTEM "ext-1.0.dtd">

<extension engine="1.0">
<id>sat_dice</id>
<title>Sat Dice</title>
<description>Эмуляция бросков игральных костей</description>
<author>satsana</author>
<version>0.1</version>
<minversion>1.4.2</minversion>
<maxtestedon>1.4.6</maxtestedon>

	<note type="uninstall" timing="pre">
Все совершенные ранее броски будут удалены безвозвратно!
	</note>

	<install><![CDATA[
define('SAT_DICE_INSTALL', 1);
require $ext_info['path'].'/install.php';
	]]></install>
	
	<uninstall><![CDATA[
define('SAT_DICE_UNINSTALL', 1);
require $ext_info['path'].'/uninstall.php';
	]]></uninstall>

	<dependencies>
		<dependency>sat_bbcode</dependency>
	</dependencies>

<hooks>

	<hook id="hd_head"><![CDATA[
if (file_exists($ext_info['path'].'/style/'.$forum_user['style'].'.css'))
	$forum_loader->add_css($ext_info['url'].'/style/'.$forum_user['style'].'.css', array('type' => 'url', 'media' => 'screen'));
else
	$forum_loader->add_css($ext_info['url'].'/style/Oxygen.css', array('type' => 'url', 'media' => 'screen'));

$forum_loader->add_js($ext_info['url'].'/script.js', array('type' => 'url', 'group' => FORUM_JS_GROUP_COUNTER));
define('SAT_DICE_START', 1);
	]]></hook>

	<hook id="mi_new_action"><![CDATA[
require $ext_info['path'].'/hooks/mi_new_action.php';
	]]></hook>

	<hook id="sat_bbcode_add_tags"><![CDATA[
if (file_exists($ext_info['path'].'/lang/'.$forum_user['language'].'.php'))
	require $ext_info['path'].'/lang/'.$forum_user['language'].'.php';
else
	require $ext_info['path'].'/lang/English.php';

require $ext_info['path'].'/hooks/dice_tag.php';
	]]></hook>

	<hook id="fn_add_post_start, ed_pre_post_edited"><![CDATA[
require $ext_info['path'].'/hooks/fn_add_post_start.php';
	]]></hook>

	<hook id="fn_add_post_end, ed_pre_redirect"><![CDATA[
require $ext_info['path'].'/hooks/fn_add_post_end.php';
	]]></hook>

	<hook id="dl_qr_get_post_info"><![CDATA[
$query['SELECT'] .= ', p.id';
	]]></hook>

</hooks>
</extension>
